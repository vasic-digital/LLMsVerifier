<div class="dashboard-container" [ngClass]="isDarkMode ? 'dark-theme' : 'light-theme'">
  <div class="dashboard-header">
    <div class="header-content">
      <h1 class="page-title">
        <lottie-player 
          [src]="'assets/animations/dashboard.json'" 
          [style]="{'width': '40px', 'height': '40px'}">
        </lottie-player>
        Dashboard Overview
      </h1>
      <button mat-raised-button color="primary" (click)="refreshDashboard()">
        <mat-icon>refresh</mat-icon>
        Refresh
      </button>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading-container">
    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    <p>Loading dashboard data...</p>
  </div>

  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- Stats Cards Section -->
    <div class="stats-grid">
      <mat-card class="stat-card stat-1">
        <div class="stat-icon">
          <lottie-player 
            [src]="'assets/animations/providers.json'" 
            [style]="{'width': '60px', 'height': '60px'}">
          </lottie-player>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ overallStats.totalProviders }}</div>
          <div class="stat-label">Providers</div>
        </div>
      </mat-card>

      <mat-card class="stat-card stat-2">
        <div class="stat-icon">
          <lottie-player 
            [src]="'assets/animations/models.json'" 
            [style]="{'width': '60px', 'height': '60px'}">
          </lottie-player>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ overallStats.totalModels }}</div>
          <div class="stat-label">Models Verified</div>
        </div>
      </mat-card>

      <mat-card class="stat-card stat-3">
        <div class="stat-icon">
          <lottie-player 
            [src]="'assets/animations/success.json'" 
            [style]="{'width': '60px', 'height': '60px'}">
          </lottie-player>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ overallStats.successRate }}%</div>
          <div class="stat-label">Success Rate</div>
        </div>
      </mat-card>

      <mat-card class="stat-card stat-4">
        <div class="stat-icon">
          <lottie-player 
            [src]="'assets/animations/brotli.json'" 
            [style]="{'width': '60px', 'height': '60px'}">
          </lottie-player>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ overallStats.brotliSupport }}</div>
          <div class="stat-label">Brotli Support</div>
        </div>
      </mat-card>
    </div>

    <!-- Tabs Section -->
    <mat-tab-group [(selectedIndex)]="selectedTab" class="dashboard-tabs">
      <mat-tab label="Providers">
        <ng-template mat-tab-content>
          <div class="tab-content">
            <div class="providers-grid">
              <mat-card *ngFor="let provider of providers" class="provider-card">
                <div class="provider-header">
                  <div class="provider-icon-container">
                    <mat-icon class="provider-icon">{{ provider.icon }}</mat-icon>
                  </div>
                  <div class="provider-info">
                    <h3>{{ provider.name }}</h3>
                    <div class="provider-stats">
                      <span class="stat">{{ provider.models }} Models</span>
                      <span class="stat">{{ provider.verified }} Verified</span>
                    </div>
                  </div>
                  <div class="provider-status">
                    <mat-icon [ngClass]="getStatusColor(provider.status)">
                      {{ getProviderStatusIcon(provider.status) }}
                    </mat-icon>
                  </div>
                </div>
                
                <div class="provider-details">
                  <div class="detail-row">
                    <span class="label">Status:</span>
                    <span class="value" [ngStyle]="{'color': getProviderStatusColor(provider.status)}">
                      {{ provider.status }}
                    </span>
                  </div>
                  <div class="detail-row">
                    <span class="label">Brotli Support:</span>
                    <span class="value brotli-value">{{ provider.brotli }} / {{ provider.models }}</span>
                  </div>
                  <div class="detail-row">
                    <span class="label">Avg Latency:</span>
                    <span class="value">{{ provider.latency }}ms</span>
                  </div>
                  <div class="detail-row">
                    <span class="label">Rating:</span>
                    <span class="value" [ngStyle]="{'color': getProviderStatusColor(provider.status)}">
                      {{ provider.status }}
                    </span>
                  </div>
                </div>
              </mat-card>
            </div>
          </div>
        </ng-template>
      </mat-tab>

      <mat-tab label="Recent Verifications">
        <ng-template mat-tab-content>
          <div class="tab-content">
            <mat-table [dataSource]="recentVerifications" class="verifications-table">
              <ng-container matColumnDef="model">
                <th mat-header-cell *matHeaderCellDef>Model</th>
                <td mat-cell *matCellDef="let row">
                  <mat-icon class="model-icon">smart_toy</mat-icon>
                  {{ row.model }}
                </td>
              </ng-container>
              
              <ng-container matColumnDef="provider">
                <th mat-header-cell *matHeaderCellDef>Provider</th>
                <td mat-cell *matCellDef="let row">{{ row.provider }}</td>
              </ng-container>
              
              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Status</th>
                <td mat-cell *matCellDef="let row">
                  <mat-chip-list>
                    <mat-chip [ngClass]="getStatusColor(row.status)">
                      {{ row.status }}
                    </mat-chip>
                  </mat-chip-list>
                </td>
              </ng-container>
              
              <ng-container matColumnDef="latency">
                <th mat-header-cell *matHeaderCellDef>Latency</th>
                <td mat-cell *matCellDef="let row">{{ row.latency }}ms</td>
              </ng-container>
              
              <ng-container matColumnDef="timestamp">
                <th mat-header-cell *matHeaderCellDef>Time</th>
                <td mat-cell *matCellDef="let row">{{ row.timestamp }}</td>
              </ng-container>
              
              <tr mat-header-row *matHeaderRowDef></tr>
              <tr mat-row *matRowDef="let row"></tr>
            </mat-table>
          </div>
        </ng-template>
      </mat-tab>

      <mat-tab label="Performance Metrics">
        <ng-template mat-tab-content>
          <div class="tab-content">
            <div class="performance-grid">
              <mat-card class="metric-card">
                <div class="metric-header">
                  <mat-icon class="metric-icon">compress</mat-icon>
                  <h3>Brotli Tests</h3>
                </div>
                <div class="metric-value large">{{ performanceMetrics.brotliTests }}</div>
                <div class="metric-label">Total tests performed</div>
              </mat-card>

              <mat-card class="metric-card">
                <div class="metric-header">
                  <mat-icon class="metric-icon">storage</mat-icon>
                  <h3>Cache Hits</h3>
                </div>
                <div class="metric-value large">{{ performanceMetrics.brotliCacheHits }}</div>
                <div class="metric-label">{{ performanceMetrics.cacheHitRate }}% hit rate</div>
              </mat-card>

              <mat-card class="metric-card">
                <div class="metric-header">
                  <mat-icon class="metric-icon">speed</mat-icon>
                  <h3>Avg Detection</h3>
                </div>
                <div class="metric-value">{{ performanceMetrics.avgDetectionTime }}s</div>
                <div class="metric-label">Time to detect Brotli</div>
              </mat-card>

              <mat-card class="metric-card">
                <div class="metric-header">
                  <mat-icon class="metric-icon">trending_down</mat-icon>
                  <h3>Bandwidth Saved</h3>
                </div>
                <div class="metric-value large">{{ performanceMetrics.bandwidthSaved }}%</div>
                <div class="metric-label">Average reduction</div>
              </mat-card>
            </div>

            <mat-card class="chart-card">
              <div class="chart-header">
                <h3>Brotli Performance Over Time</h3>
              </div>
              <div class="chart-placeholder">
                <lottie-player 
                  [src]="'assets/animations/chart.json'" 
                  [style]="{'width': '200px', 'height': '200px'}">
                </lottie-player>
                <p>Real-time performance metrics</p>
              </div>
            </mat-card>
          </div>
        </ng-template>
      </mat-tab>

      <mat-tab label="Alerts">
        <ng-template mat-tab-content>
          <div class="tab-content">
            <div class="alerts-list">
              <mat-card *ngFor="let alert of alerts" class="alert-card" [ngClass]="alert.type">
                <div class="alert-content">
                  <mat-icon class="alert-icon">
                    <ng-container [ngSwitch]="alert.type">
                      <mat-icon *ngSwitchCase="'success'" [ngStyle]="{'color': '#4CAF50'}">check_circle</mat-icon>
                      <mat-icon *ngSwitchCase="'warning'" [ngStyle]="{'color': '#FFC107'}">warning</mat-icon>
                      <mat-icon *ngSwitchCase="'error'" [ngStyle]="{'color': '#F44336'}">error</mat-icon>
                      <mat-icon *ngSwitchDefault [ngStyle]="{'color': '#2196F3'}">info</mat-icon>
                    </ng-container>
                  </mat-icon>
                  <div class="alert-message">
                    <div class="alert-title">{{ alert.message }}</div>
                    <div class="alert-timestamp">{{ alert.timestamp }}</div>
                  </div>
                </div>
              </mat-card>
            </div>
          </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
